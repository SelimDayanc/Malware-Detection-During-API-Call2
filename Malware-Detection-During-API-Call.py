import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.neural_network import MLPClassifier

data = pd.read_csv('C:/Users/MSI-PC/Desktop/dynamic_api_call_sequence_per_malware_100_0_306.csv')
print(data.head())

data1 = data.drop(columns=['hash'], axis=1)

Y = data1['malware']
X = data1.drop(columns=['malware'])

X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=32)
print('X train shape: ', X_train.shape)
print('Y train shape: ', Y_train.shape)
print('X test shape: ', X_test.shape)
print('Y test shape: ', Y_test.shape)

mlp = MLPClassifier(hidden_layer_sizes=(100, 100, 100), max_iter=1000, random_state=42)
mlp.fit(X_train, Y_train)

prediction = mlp.predict(X_test)

accuracy = accuracy_score(Y_test, prediction)
print('Doğruluk Oranı:', accuracy)

sns.countplot(data=data1, x='malware')
plt.title('Malware Sınıf Dağılımı')
plt.show()
